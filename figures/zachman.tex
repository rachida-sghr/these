% Resources:
% Arrows: http://tex.stackexchange.com/a/60627/32098
% Rotating tikz label: http://tex.stackexchange.com/a/115565/32098

% HACK (and an ugly one) since booktabs breaks vertical separators, we use tikz
% to draw them. Alignment is pretty much custom. I just hope this is gonna work
% with no adjusment when putting this in the main document.

\newcommand\tikzmark[1]{%
    \tikz[overlay,remember picture] \coordinate (#1);}

\newcommand\centbf[1]{%
    \centering\textbf{#1}}

\newcommand\centit[1]{%
    \centering\textit{#1}}

\newcommand\tworows{%
  \multirow{2}{\mycolumnwidth}{}}

\newlength{\zachmantable}
\setlength{\zachmantable}{\textwidth}

\begin{adjustbox}{width=\zachmantable,center}
    \newlength{\myfirstcolumnwidth}
    \setlength{\myfirstcolumnwidth}{\dimexpr0.25\zachmantable-2\tabcolsep\relax}
    \newlength{\mycolumnwidth}
    \setlength{\mycolumnwidth}{\dimexpr0.16\zachmantable-2\tabcolsep\relax}
    \scriptsize
    % \begin{tabulary}{\zachmantable}{m{\myfirstcolumnwidth}|m{\mycolumnwidth}|m{\mycolumnwidth}|m{\mycolumnwidth}|m{\mycolumnwidth}|m{\mycolumnwidth}|m{\mycolumnwidth}}
    \begin{tabulary}{\zachmantable}{m{\myfirstcolumnwidth}m{\mycolumnwidth}m{\mycolumnwidth}m{\mycolumnwidth}m{\mycolumnwidth}m{\mycolumnwidth}m{\mycolumnwidth}}
        % \toprule
        \cmidrule[\heavyrulewidth]{2-7}
        \tworows\tikzmark{zachmantopleft} \
        & \centbf{Data} \
        & \centbf{Function} \
        & \centbf{Network} \
        & \centbf{People} \
        & \centbf{Time} \
        & \centbf{Motivation}\tikzmark{zachmantopright} \
        % \tabularnewline
        % & \centering(Things) \
        % & \centering(Process) \
        % & \centering(Location) \
        % & \centering(People) \
        % & \centering(Time) \
        % & \centering(Motivation) \
        \tabularnewline
        & \centit{What} \
        & \centit{How} \
        & \centit{Where} \
        & \centit{Who} \
        & \centit{When} \
        & \centit{Why} \
        \tabularnewline\midrule
        
        \tikzmark{zachmanlefttop}\textbf{Scope} \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        \tabularnewline
        % \centering(Contextual) &&&&&& \
        % \tabularnewline
        \textit{Planner} &&&&&& \
        \tabularnewline\midrule
        
        \textbf{Business Model} \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        \tabularnewline
        % \textering(Conceptual) &&&&&& \
        % \tabularnewline
        \textit{Owner} &&&&&& \
        \tabularnewline\midrule
        
        \textbf{System Model} \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        \tabularnewline
        % \textering(Logical) &&&&&& \
        % \tabularnewline
        \textit{Designer} &&&&&& \
        \tabularnewline\midrule
        
        \textbf{Technology Model} \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        \tabularnewline
        % \textering(Physical) &&&&&& \
        % \tabularnewline
        \textit{Builder} &&&&&& \
        \tabularnewline\midrule

        \tikzmark{zachmanleftbottom}\textbf{Detailed Representations} \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        & \tworows \
        \tabularnewline
        % \textering(Out of context) &&&&&& \
        % \tabularnewline
        \textit{Sub-contracter} &&&&&& \
        \tabularnewline\bottomrule
    \end{tabulary}
    \begin{tikzpicture}[overlay,remember picture]

        % top horizontal arrow
        \draw[<->] let \p1=(zachmantopleft), \p2=(zachmantopright) in ($(\x1,\y1)+(1.5,0.5)$) -- node[label=Abstractions (columns)] {} ($(\x2,\y2)+(0,0.5)$);

        % left vertical arrow
        \draw[<->] let \p3=(zachmanlefttop), \p4=(zachmanleftbottom) in ($(\x3,\y3)+(-0.3,0.2)$) -- node[label={[label distance=-2ex, text depth=3ex, label position=above, rotate=90]above:Perspectives (rows)}] {} ($(\x3,\y4)+(-0.3,-0.5)$);

        % HACK: draw vertical column separators
        \def\zachmancolwidth{1.942}  % ~ column width (found manually)
        \def\zachmanleftoffset{2.83}  % ~ first column offset (found manually)
        \newcommand\drawcolsep[1]{%
            \draw[dotted] let \p3=(zachmanlefttop), \p4=(zachmanleftbottom) in ($(\x3,\y3)+(\zachmanleftoffset+#1*\zachmancolwidth,0.2)$) -- ($(\x3,\y4)+(\zachmanleftoffset+#1*\zachmancolwidth,-0.64)$);}
        \drawcolsep{0}
        \drawcolsep{1}
        \drawcolsep{2}
        \drawcolsep{3}
        \drawcolsep{4}
        \drawcolsep{5}
    \end{tikzpicture}
\end{adjustbox}
